<?xml version="1.0" ?>
<tool id="pick_open_reference_otus" name="pick open reference otus" version="1.7.0">
	<description></description>
	<requirements>
<requirement type="package" version="1.7.0">qiime</requirement>	</requirements>
	<command>pick_open_reference_otus.py
#def list_dict_to_string(list_dict):
	#set $file_list = list_dict[0]['additional_input'].__getattr__('file_name')
	#for d in list_dict[1:]:
		#set $file_list = $file_list + ',' + d['additional_input'].__getattr__('file_name')
	#end for
	#return $file_list
#end def
 -i $list_dict_to_string($input_files_input_fps) -r $reference_fp -o pick_open_reference_otus_output
#if str($otu_picking_method) != 'None':
 -m $otu_picking_method
#end if

#if str($parameter_fp) != 'None':
 -p $parameter_fp
#end if

#if str($prefilter_refseqs_fp) != 'None':
 --prefilter_refseqs_fp=$prefilter_refseqs_fp
#end if

#if str($new_ref_set_id):
 -n $new_ref_set_id
#end if

#if $parallel:
 -a
#end if

#if $jobs_to_start:
 -O $jobs_to_start
#end if

#if $percent_subsample:
 -s $percent_subsample
#end if

#if $prefilter_percent_id:
 --prefilter_percent_id=$prefilter_percent_id
#end if

#if str($step1_otu_map_fp) != 'None':
 --step1_otu_map_fp=$step1_otu_map_fp
#end if

#if str($step1_failures_fasta_fp) != 'None':
 --step1_failures_fasta_fp=$step1_failures_fasta_fp
#end if

#if $suppress_step4:
 --suppress_step4
#end if

#if $min_otu_size:
 --min_otu_size=$min_otu_size
#end if

#if $suppress_taxonomy_assignment:
 --suppress_taxonomy_assignment
#end if

#if $suppress_align_and_tree:
 --suppress_align_and_tree
#end if
;
compress_path.py -i pick_open_reference_otus_output -o $output_dir
</command>
	<inputs>
		<repeat name="input_files_input_fps" optional="False" title="input_fps">
			<param label="-i/--input_fps: the input sequences filepath or comma-separated list of filepaths" name="additional_input" type="data"/>
		</repeat>
		<param label="-r/--reference_fp: the reference sequences" name="reference_fp" optional="False" type="data"/>
		<param label="-m/--otu_picking_method: The OTU picking method to use for reference and de novo steps. Passing usearch61, for example, means that usearch61 will be used for the de novo steps and usearch61_ref will be used for reference steps. [default: uclust]" name="otu_picking_method" optional="True" type="select">
			<option selected="True" value="None">Selection is Optional</option>
			<option value="uclust">uclust</option>
			<option value="usearch61">usearch61</option>
		</param>
		<param label="-p/--parameter_fp: path to the parameter file, which specifies changes to the default behavior. See http://www.qiime.org/documentation/file_formats.html#qiime-parameters . [if omitted, default values will be used]" name="parameter_fp" optional="True" type="data"/>
		<param label="--prefilter_refseqs_fp: the reference sequences to use for the prefilter, if different from the reference sequecnces to use for the OTU picking [default: same as passed for --reference_fp]" name="prefilter_refseqs_fp" optional="True" type="data"/>
		<param default="New" label="-n/--new_ref_set_id: Unique identifier for OTUs that get created in this ref set (this is useful to support combining of reference sets) [default:New]" name="new_ref_set_id" optional="True" type="text"/>
		<param label="-a/--parallel: Run in parallel where available [default: False]" name="parallel" selected="False" type="boolean"/>
		<param default="1" label="-O/--jobs_to_start: Number of jobs to start. NOTE: you must also pass -a to run in parallel, this defines the number of jobs to be started if and only if -a is passed [default: 1]" name="jobs_to_start" optional="True" type="integer"/>
		<param default="0.001" label="-s/--percent_subsample: Percent of failure sequences to include in the subsample to cluster de novo (larger numbers should give more comprehensive ,results but will be slower) [default:0.001]" name="percent_subsample" optional="True" type="float"/>
		<param default="0.60" label="--prefilter_percent_id: Sequences are pre-clustered at this percent id against the reference and any reads which fail to hit are discarded (a quality filter); pass 0.0 to disable [default:0.60]" name="prefilter_percent_id" optional="True" type="float"/>
		<param label="--step1_otu_map_fp: reference OTU picking OTU map  (to avoid rebuilding if one has already been built)" name="step1_otu_map_fp" optional="True" type="data"/>
		<param label="--step1_failures_fasta_fp: reference OTU picking failures fasta filepath  (to avoid rebuilding if one has already been built)" name="step1_failures_fasta_fp" optional="True" type="data"/>
		<param label="--suppress_step4: suppress the final de novo OTU picking step  (may be necessary for extremely large data sets) [default: False]" name="suppress_step4" selected="False" type="boolean"/>
		<param default="2" label="--min_otu_size: the minimum otu size (in number of sequences) to retain the otu [default: 2]" name="min_otu_size" optional="True" type="integer"/>
		<param label="--suppress_taxonomy_assignment: skip the taxonomy assignment step, resulting in an OTU table without taxonomy [default: False]" name="suppress_taxonomy_assignment" selected="False" type="boolean"/>
		<param label="--suppress_align_and_tree: skip the sequence alignment and tree-building steps [default: False]" name="suppress_align_and_tree" selected="False" type="boolean"/>
	</inputs>
	<outputs>
		<data format="tgz" name="output_dir"/>
	</outputs>
	<help>
</help>
</tool>
