<?xml version="1.0" ?>
<tool id="pick_closed_reference_otus" name="pick closed reference otus" version="1.7.0">
	<description>Closed-reference OTU picking/Shotgun UniFrac workflow.</description>
	<requirements>
		<requirement type="package">qiime</requirement>
	</requirements>
	<command>pick_closed_reference_otus.py -i $input_fp -r $reference_fp -o pick_closed_reference_otus_output
#if str($parameter_fp) != 'None':
 -p $parameter_fp
#end if

#if str($taxonomy_fp) != 'None':
 -t $taxonomy_fp
#end if

#if $parallel:
 -a
#end if

#if $jobs_to_start:
 -O $jobs_to_start
#end if
;
compress_path.py -i pick_closed_reference_otus_output -o $output_dir
</command>
	<inputs>
		<param label="-i/--input_fp: the input sequences" name="input_fp" optional="False" type="data"/>
		<param label="-r/--reference_fp: the reference sequences" name="reference_fp" optional="False" type="data"/>
		<param label="-p/--parameter_fp: path to the parameter file, which specifies changes to the default behavior. See http://www.qiime.org/documentation/file_formats.html#qiime-parameters . [if omitted, default values will be used]" name="parameter_fp" optional="True" type="data"/>
		<param label="-t/--taxonomy_fp: the taxonomy map [default: None]" name="taxonomy_fp" optional="True" type="data"/>
		<param label="-a/--parallel: Run in parallel where available [default: False]" name="parallel" selected="False" type="boolean"/>
		<param default="1" label="-O/--jobs_to_start: Number of jobs to start. NOTE: you must also pass -a to run in parallel, this defines the number of jobs to be started if and only if -a is passed [default: 1]" name="jobs_to_start" optional="True" type="integer"/>
	</inputs>
	<outputs>
		<data format="tgz" name="output_dir"/>
	</outputs>
	<help>This script picks OTUs using a closed reference and constructs an OTU table. Taxonomy is assigned using a pre-defined taxonomy map of reference sequence OTU to taxonomy. If full-length genomes are provided as the reference sequences, this script applies the Shotgun UniFrac method.
</help>
</tool>
