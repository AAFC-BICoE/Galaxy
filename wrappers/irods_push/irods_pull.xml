<tool id="irods_pull_main" name="Import to Galaxy from irods" version="1.0_wrap1" >

	<description>Pull file into galaxy history from your irods filesystem.</description>
	<requirements>
		<requirement type="package" version="0.5.0">
		pythonirodsclient
		</requirement>
	</requirements>
	<code file="get_n_files.py" />
	<command interpreter="python">
	#import os.path
	irods_pull.py
	#if $typePath.type_path=="abs"
		#for $i in $typePath.abs_dirs
			'$i.filenamesAbs'
		#end for
		$output.id $__new_file_path__ $typePath.type_path 
	#else
		'$typePath.filenamesExi'
		$output.id $__new_file_path__ $typePath.type_path
	#end if	


	</command>
	
	<inputs>
		<conditional name="typePath">
			<param type="select" name="type_path" label="Choose how you will pass in your file name: " display="radio">
				<option value="abs">Shared File Path</option>
				<option value="exi">Local File Path</option>
			</param>
			<when value="abs">
				<repeat name="abs_dirs" title="Input file path of any file you have acces to:" default="1" help="This parameter is generally helpful to access files which are not directly in your user directories.">
					<param name="filenamesAbs" type="text" label="Shared File path:" />
				</repeat>
			</when>
			<when value="exi">
				<param type="text" name="directory" label="Directory location (/'yourzone'/home/'yourusername'):" refresh_on_change="True" />	
				<param name="filenamesExi" type="select" label="Existing files:" dynamic_options="give_path_get_files(directory)" multiple="true" optional="true" help="Click on the blank space in the box to get a list of available files."/>
			</when>
		</conditional>
	</inputs>

			
	<outputs>
<!--		<data name="output1" format="auto" label="Upload to Galaxy: " >
			<filter>typePath['type_path']=="abs"</filter>
		</data>
		<data name="output2" format="auto" label="Upload to Galaxy: " >
			<filter>typePath['type_path']=="exi"</filter>
		</data>-->
 		<collection type="list" label="$job_name" name="output">
			<discover_datasets pattern="(?P&lt&gt;.*)" directory="SampleDataset" />
		</collection>
<!--<data name="output" format="auto" />-->
		
	</outputs>

	
	<help>
	Winter is coming...
	</help>
</tool>
