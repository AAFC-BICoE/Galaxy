<?xml version="1.0"?>
<tool_dependency>
    <package name="perl" version="5.18.1">
        <repository name="package_perl_5_18" owner="liuyue" />
    </package>

    <package name="augustus" version="3.0.2">
        <repository name="package_augustus_3_0_2" owner="liuyue" prior_installation_required="True" />
    </package> 

    <package name="snap" version="2006-07-28">
        <repository name="package_snap_2006_07_28" owner="liuyue" prior_installation_required="True" />
    </package>

    <package name="repeatmasker" version="4.0.5">
        <install version="1.0">
            <actions>
                <action type="download_by_url">http://tandem.bu.edu/trf/downloads/trf404.linux64</action>
		<action type="set_environment_for_install">
			<repository name="package_rmblast_2_2_28" owner="liuyue">
				<package name="rmblast" version="2.2.28" />
			</repository>
		</action>
		<action type="move_file">
			<source>./trf404.linux64</source>
			<destination>$INSTALL_DIR</destination>
		</action>
                <action type="set_environment">
                    <environment_variable name="PATH" action="prepend_to">$INSTALL_DIR</environment_variable>
                </action>
		<action type="download_by_url">http://www.repeatmasker.org/RepeatMasker-open-4-0-5.tar.gz</action>
		<!--the configure script is interactive. The questions asked are:
			location of perl
			install dir
			trf location
			select search program - rmblast
			location of rmblast
			set to be default search engine
			done -->
                <action type="shell_command">tmp=`which blastn`;tmp=${tmp%/*};echo -e "\n`which perl`\n.\n$INSTALL_DIR/trf404.linux64\n2\n${tmp}\ny\n5\n" |./configure</action>
		<action type="move_directory_files">
			<source_directory>.</source_directory>
			<destination_directory>$INSTALL_DIR</destination_directory>
		</action>
            </actions>
        </install>
    </package>

    <package name="exonerate" version="2.2.0">
        <install version="1.0">
            <actions>
                <action type="download_by_url">https://www.ebi.ac.uk/~guy/exonerate/exonerate-2.2.0-x86_64.tar.gz</action>
		<action type="move_directory_files">
			<source_directory>.</source_directory>
			<destination_directory>$INSTALL_DIR</destination_directory>
		</action>
                <action type="set_environment">
                    <environment_variable name="PATH" action="prepend_to">$INSTALL_DIR/bin</environment_variable>
                </action>
            </actions>
        </install>
    </package>


    <package name="maker" version="2.31.6">
        <install version="1.0">
            <actions>
		<!-- download must be the first action, otherwise the file disappears after downloading -->
                <action type="download_by_url">http://yandell.topaz.genetics.utah.edu/maker_downloads/F7BF/36D9/5A75/F93993D356C3396F722AD07D8B52/maker-2.31.6.tgz</action>
		<action type="set_environment_for_install">
			<repository name="package_snap_2006_07_28" owner="liuyue">
				<package name="snap" version="2006-07-28" />
			</repository>
		</action>
		<action type="set_environment_for_install">
			<repository name="package_augustus_3_0_2" owner="liuyue">
				<package name="augustus" version="3.0.2" />
			</repository>
		</action>

		<action type="setup_perl_environment">
		   <repository name="package_perl_5_18" owner="liuyue" >
			<package name="perl" version="5.18.1" />
		   </repository>
			<package>http://search.cpan.org/CPAN/authors/id/A/AD/ADAMK/File-Which-1.09.tar.gz</package> <!--File::Which-->
		</action>

                <action type="shell_command">echo "checking perl requirements"</action> 
                <action type="shell_command">cpan -l</action> 

                <!-- action type="shell_command">echo "n" | perl ./src/Build.PL</action> 
                <action type="shell_command">./src/Build install</action> -->
		<action type="move_directory_files">
			<source_directory>.</source_directory>
			<destination_directory>$INSTALL_DIR</destination_directory>
		</action>
                <action type="set_environment">
                    <environment_variable name="PATH" action="prepend_to">$INSTALL_DIR/bin</environment_variable>
                </action>
                <action type="set_environment">
                    <environment_variable name="MAKERPATH" action="set_to">$INSTALL_DIR</environment_variable>
                </action>
            </actions>
        </install>
        <readme>
this is installer for maker
Note that the link here is tied to my email address and we should store the files somewhere on biocluster
instead of having to register and download everytime

Note: this also installs snap, augustus, blast, exonerate, repeatmasker inside of Maker's directory.
($INSTALL_DIR/dependencies)
We do this instead of making them a dependency is to make sure we have versions that work well together
Also this makes it easier for maker to find these programs.

Repeat masker also need trf and rmblast. 

Currently this works only for linux-64. (matters for rmblast, ncbiblast, trf,exonerate)
Some has source code, but building them is complicated

        </readme>
    </package>
</tool_dependency>

