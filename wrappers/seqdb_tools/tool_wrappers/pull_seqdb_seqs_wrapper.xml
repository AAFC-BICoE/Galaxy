<tool id="seqdb_pull_seqs" name="Load Sequences from SeqDB" version="1.2">
  <description> through web services. Produces a fasta file of the specified sequences. </description>
  <requirements>
      <requirement type="package" version="1.2">package_seqdb_py</requirement>
  </requirements>
  
  <command>
      
      pull_seqdb_seqs -c $config_file $pull_type_cond.pull_type
        #if $pull_type_cond.pull_type != "its"
            #if $pull_type_cond.specimen_num
                --specNum $pull_type_cond.specimen_num
            #end if
        
            #if $pull_type_cond.sequence_name
                --seqName  $pull_type_cond.sequence_name
            #end if
        #end if
      
  </command>

  <inputs>
      <param name="config_file" type="data" label="Sequence Database Configuration File *" optional="False" />
      
      <conditional name="pull_type_cond">
          <param name="pull_type" type="select" label="Select which sequences you would like to load *">
              <option value="its" help="ITS sequences are defined as sequences linked to a region which has ITS region symbols in its name.">ITS sequences</option>
              <option value="consensus">Consensus sequences</option>
              <option value="all">All sequences</option>
          </param>
          <when value="all">
              <param name="specimen_num" type="text" label="Specimen Identifier" optional="True" />
              <param name="sequence_name" type="text" label="Sequence Name keyword" optional="True" />
          </when>
          <when value="consensus">
              <param name="specimen_num" type="text" label="Specimen Identifier" optional="True" />
              <param name="sequence_name" type="text" label="Sequence Name keyword" optional="True" />
          </when>
      </conditional>
      
  </inputs>
  
  <outputs>
    <data name="seqdb_sequences"
        format="fasta"
        from_work_dir="seqdb_sequences.fasta"
        label="Sequences from SeqDB" />
    <data name="SeqDB_pull_log"
        format="txt"
        from_work_dir="seqdb_pull.log"
        label="Log file of extracting ITS sequences from SeqDB" />
  </outputs>

  <!-- Provide explanations for various exit status codes. Avoid situations where tool exists with status 0 but other errors (in Galaxy) set its status to Error -->
  <stdio>
  	   <!-- Since exit code 0 is not specified, the tool will execute successfully, even if Galaxy writes something to stderr. -->
  	  <exit_code range="1:" level="fatal" description="Error" />
      <exit_code range="2"   level="fatal"   description="Out of Memory" />
      <exit_code range="3:5" level="warning" description="Low disk space" />
      <exit_code range="6:63"  level="fatal"   description="Tool execution error (exit codes 6-63)" />
      <exit_code range="64"  level="fatal"   description="Command line usage error" />
      <exit_code range="65:72"  level="fatal"   description="Tool execution error (exit codes 65-72)" />
      <exit_code range="73"  level="fatal"   description="Can't create (user) output file" />
      <exit_code range="74:"  level="fatal"   description="Tool execution error (exit codes 74 and up)" />
  </stdio>

  <tests>
    <test>
      <output name="out_file" file="seqdb_sequences.fasta" />
    </test>
  </tests>

  <help>
      
      Required fields are marked with a * .
      
      **What it does**
      
      The tool fetches different types of sequences from Sequence DB and writes them to a fasta file.
      
      
      **What is a "Sequence Database Configuration File"?**
      
      Sequence Database Configuration File is a file that contains SeqDB API connection parameters. To generate this file, use "SeqDB Configuration" tool.
      
      
  </help>

</tool>
